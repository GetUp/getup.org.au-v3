# Cloudflare Worker config for the Decap CMS proxy
name = "getup-v3-decap-proxy-worker"
main = "cloudflare/decap-proxy-worker.js"
compatibility_date = "2024-12-01"
workers_dev = false

# Replace with your Cloudflare Account ID (required for deploys)
account_id = "1c1e85ffaa0dc8de2a075921c2376730"

# Environment variables
[vars]
ALLOWED_BRANCH = "main"
REPO_OWNER = "GetUp"
REPO_NAME = "getup.org.au-v3"
CF_ACCESS_TEAM_NAME = "getup"
CF_ACCESS_AUD = "ce38525cd2b19766460ff7548bee32958321c7575f820401a35b41d93708b3d1"
[env.production]
# Uncomment and set a production-only route if you want to bind to a specific hostname/path
# routes = [
#   { pattern = "proxy.getup.org.au/repo/*", zone_name = "getup.org.au" }
# ]

[observability]
[observability.logs]
enabled = false
head_sampling_rate = 1
invocation_logs = true
persist = true

# =============================================================================
# Pages Configuration (for Cloudflare Pages Functions)
# =============================================================================
# This config is used by `wrangler pages deploy` for the Pages site.
# The Worker config above is used by `wrangler deploy` for the proxy worker.

[pages]
# Pages project name (matches Cloudflare dashboard)
name = "getup-static-v3"

# Service binding: connects Pages Function to the private Decap proxy worker
[[pages.services]]
binding = "DECAP_WORKER"
service = "getup-v3-decap-proxy-worker"
